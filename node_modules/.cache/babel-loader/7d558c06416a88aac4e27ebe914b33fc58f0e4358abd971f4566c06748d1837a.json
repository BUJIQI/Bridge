{"ast":null,"code":"import { ref, onMounted, computed } from 'vue';\nimport { useUserStore } from '@/store/user';\nimport axios from '@/api/axios';\nexport default {\n  setup() {\n    const userStore = useUserStore();\n    userStore.setSelectedHistory(localStorage.getItem('SelectedPeriod'));\n    const selectedHistory = computed(() => userStore.selectedHistory);\n    const Data = ref({});\n    const fetchData = async () => {\n      try {\n        const response = await axios.get('/users/look1/', {\n          withCredentials: true\n        });\n        Data.value = response.data;\n        console.log('获取周期形势数据成功:', Data.value);\n      } catch (error) {\n        console.error('获取周期形势数据时发生错误:', error);\n      }\n    };\n\n    // 在组件挂载时请求数据\n    onMounted(() => {\n      fetchData();\n    });\n\n    // 计算属性：检查是否存在 selectedHistory 字段对应的数据\n    const matchingKey = computed(() => {\n      return Object.keys(Data.value).find(key => key.includes(selectedHistory.value));\n    });\n\n    // 计算属性：返回过滤后的数据\n    const filteredData = computed(() => {\n      const dataEntries = Object.entries(Data.value[matchingKey.value] || {});\n      return dataEntries.slice(1).reduce((acc, [key, value]) => {\n        acc[key] = value;\n        return acc;\n      }, {});\n    });\n    return {\n      Data,\n      matchingKey,\n      filteredData,\n      selectedHistory\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","useUserStore","axios","setup","userStore","setSelectedHistory","localStorage","getItem","selectedHistory","Data","fetchData","response","get","withCredentials","value","data","console","log","error","matchingKey","Object","keys","find","key","includes","filteredData","dataEntries","entries","slice","reduce","acc"],"sources":["D:\\当下文件\\python\\Bridge-1\\src\\components\\PeriodSituation.vue"],"sourcesContent":["<template>\r\n  <div class=\"panel panel-default mt-3\">\r\n      <div class=\"panel-heading\">\r\n          <h3 class=\"panel-title\">{{ matchingKey }}</h3> \r\n      </div>\r\n      <div class=\"panel-body\">\r\n        <table class=\"table table-striped\">\r\n          <tbody>\r\n            <tr v-for=\"(value, key) in filteredData\" :key=\"key\">\r\n              <td class=\"highlight\">{{ key }}</td>\r\n              <td>{{ value }}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue';\r\nimport { useUserStore } from '@/store/user';\r\nimport axios from '@/api/axios';\r\n\r\nexport default {\r\n  setup() {\r\n      const userStore = useUserStore();\r\n        userStore.setSelectedHistory(localStorage.getItem('SelectedPeriod'));\r\n        \r\n      const selectedHistory = computed(() => userStore.selectedHistory);  \r\n      const Data = ref({}); \r\n\r\n      const fetchData = async () => {\r\n          try {\r\n              const response = await axios.get('/users/look1/', {\r\n                  withCredentials: true\r\n              });\r\n              Data.value = response.data; \r\n              console.log('获取周期形势数据成功:', Data.value);\r\n          } catch (error) {\r\n              console.error('获取周期形势数据时发生错误:', error);\r\n          }\r\n      };\r\n\r\n      // 在组件挂载时请求数据\r\n      onMounted(() => {\r\n          fetchData();\r\n      });\r\n\r\n      // 计算属性：检查是否存在 selectedHistory 字段对应的数据\r\n      const matchingKey = computed(() => {\r\n          return Object.keys(Data.value).find(key => key.includes(selectedHistory.value));\r\n      });\r\n\r\n      // 计算属性：返回过滤后的数据\r\n      const filteredData = computed(() => {\r\n          const dataEntries = Object.entries(Data.value[matchingKey.value] || {});\r\n          return dataEntries.slice(1).reduce((acc, [key, value]) => {\r\n              acc[key] = value;\r\n              return acc;\r\n          }, {});\r\n      });\r\n\r\n      return {\r\n          Data,\r\n          matchingKey,\r\n          filteredData,\r\n          selectedHistory\r\n      };\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.panel {\r\n  margin-top: 20px;\r\n  border-radius: 8px;\r\n}\r\n\r\n.panel-heading {\r\n  background-color: #f7f7f9;\r\n  padding: 15px;\r\n}\r\n\r\n.panel-body {\r\n  padding: 20px;\r\n  border-radius: 8px;\r\n}\r\n\r\n.table-striped > tbody > tr:nth-child(odd) {\r\n  background-color: #f9f9f9;\r\n  border-radius: 5px;\r\n}\r\n\r\n.highlight {\r\n    background-color: #f3776c;\r\n    color: #fff;\r\n}\r\n</style>\r\n"],"mappings":"AAmBA,SAASA,GAAG,EAAEC,SAAS,EAAEC,QAAO,QAAS,KAAK;AAC9C,SAASC,YAAW,QAAS,cAAc;AAC3C,OAAOC,KAAI,MAAO,aAAa;AAE/B,eAAe;EACbC,KAAKA,CAAA,EAAG;IACJ,MAAMC,SAAQ,GAAIH,YAAY,CAAC,CAAC;IAC9BG,SAAS,CAACC,kBAAkB,CAACC,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAC,CAAC;IAEtE,MAAMC,eAAc,GAAIR,QAAQ,CAAC,MAAMI,SAAS,CAACI,eAAe,CAAC;IACjE,MAAMC,IAAG,GAAIX,GAAG,CAAC,CAAC,CAAC,CAAC;IAEpB,MAAMY,SAAQ,GAAI,MAAAA,CAAA,KAAY;MAC1B,IAAI;QACA,MAAMC,QAAO,GAAI,MAAMT,KAAK,CAACU,GAAG,CAAC,eAAe,EAAE;UAC9CC,eAAe,EAAE;QACrB,CAAC,CAAC;QACFJ,IAAI,CAACK,KAAI,GAAIH,QAAQ,CAACI,IAAI;QAC1BC,OAAO,CAACC,GAAG,CAAC,aAAa,EAAER,IAAI,CAACK,KAAK,CAAC;MAC1C,EAAE,OAAOI,KAAK,EAAE;QACZF,OAAO,CAACE,KAAK,CAAC,gBAAgB,EAAEA,KAAK,CAAC;MAC1C;IACJ,CAAC;;IAED;IACAnB,SAAS,CAAC,MAAM;MACZW,SAAS,CAAC,CAAC;IACf,CAAC,CAAC;;IAEF;IACA,MAAMS,WAAU,GAAInB,QAAQ,CAAC,MAAM;MAC/B,OAAOoB,MAAM,CAACC,IAAI,CAACZ,IAAI,CAACK,KAAK,CAAC,CAACQ,IAAI,CAACC,GAAE,IAAKA,GAAG,CAACC,QAAQ,CAAChB,eAAe,CAACM,KAAK,CAAC,CAAC;IACnF,CAAC,CAAC;;IAEF;IACA,MAAMW,YAAW,GAAIzB,QAAQ,CAAC,MAAM;MAChC,MAAM0B,WAAU,GAAIN,MAAM,CAACO,OAAO,CAAClB,IAAI,CAACK,KAAK,CAACK,WAAW,CAACL,KAAK,KAAK,CAAC,CAAC,CAAC;MACvE,OAAOY,WAAW,CAACE,KAAK,CAAC,CAAC,CAAC,CAACC,MAAM,CAAC,CAACC,GAAG,EAAE,CAACP,GAAG,EAAET,KAAK,CAAC,KAAK;QACtDgB,GAAG,CAACP,GAAG,IAAIT,KAAK;QAChB,OAAOgB,GAAG;MACd,CAAC,EAAE,CAAC,CAAC,CAAC;IACV,CAAC,CAAC;IAEF,OAAO;MACHrB,IAAI;MACJU,WAAW;MACXM,YAAY;MACZjB;IACJ,CAAC;EACL;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}