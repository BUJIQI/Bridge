{"ast":null,"code":"import { useUserStore } from '@/store/user';\nimport { ref, reactive, onMounted } from 'vue';\nimport axios from '@/api/axios';\nexport default {\n  setup() {\n    const userStore = useUserStore();\n    const userInfo = userStore.userInfo;\n    const userProfile = reactive({\n      name: userInfo.username,\n      studentId: userInfo.stuid,\n      teamName: userInfo.team_name,\n      class: userInfo.user_class,\n      group: userInfo.group,\n      company: userInfo.number,\n      password: '',\n      phone: '',\n      email: ''\n    });\n    const editingProfile = reactive({\n      name: '',\n      studentId: '',\n      teamName: '',\n      class: '',\n      group: '',\n      company: '',\n      password: '',\n      phone: '',\n      email: ''\n    });\n    const isEditing = ref(false);\n    const historyGames = ref([]);\n    const toggleEditMode = () => {\n      isEditing.value = !isEditing.value;\n      if (isEditing.value) {\n        Object.assign(editingProfile, userProfile);\n      }\n    };\n    const cancelEdit = () => {\n      isEditing.value = false;\n    };\n    const saveProfile = () => {\n      Object.assign(userProfile, editingProfile);\n      isEditing.value = false;\n    };\n\n    // 在组件挂载时发送GET请求\n    onMounted(async () => {\n      try {\n        const response = await axios.get('/users/user_data/', {\n          withCredentials: true\n        });\n        const data = response.data;\n\n        // 处理历史轮次\n        if (data.history_rounds !== \"无历史对局\") {\n          historyGames.value = Object.entries(data.history_rounds).map(([endTime, details]) => ({\n            id: Date.now() + Math.random(),\n            // 生成唯一的id\n            endTime: endTime,\n            endCycle: details[\"结束周期\"],\n            finalRating: details[\"末周期评分\"],\n            rank: `${details[\"名次\"]}/2`\n          }));\n        } else {\n          historyGames.value = [];\n        }\n      } catch (error) {\n        console.error(\"获取用户数据失败:\", error);\n      }\n    });\n    return {\n      userProfile,\n      editingProfile,\n      isEditing,\n      historyGames,\n      toggleEditMode,\n      cancelEdit,\n      saveProfile\n    };\n  }\n};","map":{"version":3,"names":["useUserStore","ref","reactive","onMounted","axios","setup","userStore","userInfo","userProfile","name","username","studentId","stuid","teamName","team_name","class","user_class","group","company","number","password","phone","email","editingProfile","isEditing","historyGames","toggleEditMode","value","Object","assign","cancelEdit","saveProfile","response","get","withCredentials","data","history_rounds","entries","map","endTime","details","id","Date","now","Math","random","endCycle","finalRating","rank","error","console"],"sources":["D:\\当下文件\\python\\Bridge-1\\src\\components\\AllHistory.vue"],"sourcesContent":["<template>\r\n    <div class=\"panel panel-default mt-3\">\r\n        <div class=\"panel-body\">\r\n            <div class=\"row h-100\">\r\n                <div class=\"col-md-4\">\r\n                    <div class=\"user-profile\" v-if=\"!isEditing\">\r\n                        <h4 class=\"card-header\">个人信息</h4>\r\n                        <hr> <!-- 添加分割线 -->\r\n                        <p><strong>姓名:</strong> {{ userProfile.name }}</p>\r\n                        <p><strong>学号:</strong> {{ userProfile.studentId }}</p>\r\n                        <p><strong>队名:</strong> {{ userProfile.teamName }}</p>\r\n                        <p><strong>班级:</strong> {{ userProfile.class }}</p>\r\n                        <p><strong>组:</strong> 第{{ userProfile.group }}组</p>\r\n                        <p><strong>企业:</strong> 第{{ userProfile.company }}企业</p>\r\n                        <button class=\"btn btn-primary\" @click=\"toggleEditMode\">编辑资料</button>\r\n                    </div>\r\n\r\n                    <div class=\"edit-form\" v-if=\"isEditing\">\r\n                        <h4 class=\"card-header\">编辑个人资料</h4>\r\n                        <hr> <!-- 添加分割线 -->\r\n                        <div class=\"form-group\">\r\n                            <label for=\"name\">姓名</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"name\" v-model=\"editingProfile.name\">\r\n                        </div>\r\n                        <div class=\"form-group\">\r\n                            <label for=\"studentId\">学号</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"studentId\" v-model=\"editingProfile.studentId\">\r\n                        </div>\r\n                        <div class=\"form-group\">\r\n                            <label for=\"teamName\">队名</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"teamName\" v-model=\"editingProfile.teamName\">\r\n                        </div>\r\n                        <div class=\"form-group\">\r\n                            <label for=\"class\">班级</label>\r\n                            <input type=\"text\" class=\"form-control\" id=\"class\" v-model=\"editingProfile.class\">\r\n                        </div>\r\n                        <div class=\"form-group\">\r\n                            <label for=\"password\">密码</label>\r\n                            <input type=\"password\" class=\"form-control\" id=\"password\" v-model=\"editingProfile.password\">\r\n                        </div>\r\n                        <div class=\"form-group\">\r\n                            <label for=\"phone\">手机</label>\r\n                            <input type=\"tel\" class=\"form-control\" id=\"phone\" v-model=\"editingProfile.phone\">\r\n                        </div>\r\n                        <div class=\"form-group\">\r\n                            <label for=\"email\">邮箱</label>\r\n                            <input type=\"email\" class=\"form-control\" id=\"email\" v-model=\"editingProfile.email\">\r\n                        </div>\r\n                        <button type=\"button\" class=\"btn btn-secondary\" @click=\"cancelEdit\">取消</button>\r\n                        <button type=\"button\" class=\"btn btn-thirdly\" @click=\"saveProfile\">保存</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"col-md-8\">\r\n                    <div class=\"table-container\">\r\n                        <div class=\"header\">\r\n                            历史对局\r\n                        </div>\r\n                        <table>\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>结束时间</th>\r\n                                    <th>结束周期</th>\r\n                                    <th>末周期评分</th>\r\n                                    <th>名次</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                <tr v-for=\"game in historyGames\" :key=\"game.id\">\r\n                                    <td>{{ game.endTime }}</td>\r\n                                    <td>{{ game.endCycle }}</td>\r\n                                    <td>{{ game.finalRating === '未评分' ? '-' : game.finalRating }}</td>\r\n                                    <td>{{ game.rank === '未评分/2' ? '-' : game.rank }}</td>\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { useUserStore } from '@/store/user';\r\nimport { ref, reactive, onMounted } from 'vue';\r\nimport axios from '@/api/axios'; \r\n\r\nexport default {\r\n    setup() {\r\n        const userStore = useUserStore();\r\n        const userInfo = userStore.userInfo;\r\n        const userProfile = reactive({\r\n            name: userInfo.username,\r\n            studentId: userInfo.stuid,\r\n            teamName: userInfo.team_name,\r\n            class: userInfo.user_class,\r\n            group: userInfo.group,\r\n            company: userInfo.number,\r\n            password: '',\r\n            phone: '',\r\n            email: ''\r\n        });\r\n\r\n        const editingProfile = reactive({\r\n            name: '',\r\n            studentId: '',\r\n            teamName: '',\r\n            class: '',\r\n            group: '',\r\n            company: '',\r\n            password: '',\r\n            phone: '',\r\n            email: ''\r\n        });\r\n\r\n        const isEditing = ref(false);\r\n        const historyGames = ref([]);\r\n\r\n        const toggleEditMode = () => {\r\n            isEditing.value = !isEditing.value;\r\n            if (isEditing.value) {\r\n                Object.assign(editingProfile, userProfile);\r\n            }\r\n        };\r\n\r\n        const cancelEdit = () => {\r\n            isEditing.value = false;\r\n        };\r\n\r\n        const saveProfile = () => {\r\n            Object.assign(userProfile, editingProfile);\r\n            isEditing.value = false;\r\n        };\r\n\r\n        // 在组件挂载时发送GET请求\r\n        onMounted(async () => {\r\n            try {\r\n                const response = await axios.get('/users/user_data/', {withCredentials: true});\r\n                const data = response.data;\r\n\r\n                // 处理历史轮次\r\n                if (data.history_rounds !== \"无历史对局\") {\r\n                    historyGames.value = Object.entries(data.history_rounds).map(([endTime, details]) => ({\r\n                        id: Date.now() + Math.random(), // 生成唯一的id\r\n                        endTime: endTime,\r\n                        endCycle: details[\"结束周期\"],\r\n                        finalRating: details[\"末周期评分\"],\r\n                        rank: `${details[\"名次\"]}/2`\r\n                    }));\r\n                } else {\r\n                    historyGames.value = [];\r\n                }\r\n            } catch (error) {\r\n                console.error(\"获取用户数据失败:\", error);\r\n            }\r\n        });    \r\n\r\n        return {\r\n            userProfile,\r\n            editingProfile,\r\n            isEditing,\r\n            historyGames,\r\n            toggleEditMode,\r\n            cancelEdit,\r\n            saveProfile,\r\n        };\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.panel {\r\n    margin-top: 20px;\r\n    border-radius: 8px;\r\n}\r\n\r\n.panel-body {\r\n    padding: 15px;\r\n}\r\n\r\n.user-profile {\r\n    background-color: #f8f9fa; \r\n    padding: 20px;\r\n    border: 1px solid #ddd;\r\n    border-radius: 5px;\r\n}\r\n\r\n.user-name {\r\n    font-size: 24px;\r\n    color: #333; \r\n    margin-bottom: 10px;\r\n}\r\n\r\n.btn-primary {\r\n    background-color: #c00; \r\n    border-color: #c00;  \r\n}\r\n\r\n.btn-primary:hover,\r\n.btn-primary:focus {\r\n    background-color: rgb(190, 0, 0); \r\n    border-color: rgb(190, 0, 0);\r\n}\r\n\r\n.btn-secondary {\r\n    background-color: #6c757d; \r\n    border-color: #6c757d;\r\n    color: #fff;\r\n    margin: 10px 10px 0 0;\r\n}\r\n\r\n.btn-secondary:hover,\r\n.btn-secondary:focus {\r\n    background-color: #545b62;\r\n    border-color: #545b62;\r\n}\r\n\r\n.btn-thirdly {\r\n    background-color: #c00; \r\n    border-color: #c00; \r\n    color: #fff;\r\n    margin: 10px 0 0 0;\r\n}\r\n\r\n.btn-thirdly:hover,\r\n.btn-thirdly:focus {\r\n    background-color: rgb(190, 0, 0); \r\n    border-color: rgb(190, 0, 0);\r\n}\r\n\r\n.edit-form {\r\n    background-color: #f8f9fa; \r\n    padding: 20px;\r\n    border: 1px solid #ddd;\r\n    border-radius: 5px;\r\n}\r\n\r\n.table-container {\r\n    background-color: #f8f9fa;\r\n    border: 1px solid #ddd;\r\n    border-radius: 5px;\r\n    padding: 10px;\r\n    margin-bottom: 50px;\r\n}\r\n\r\n.table-container .header {\r\n    font-size: 18px;\r\n    color: #333;\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.table-container table {\r\n    width: 100%;\r\n    border-collapse: collapse;\r\n}\r\n\r\n.table-container th, .table-container td {\r\n    border: 1px solid #ddd;\r\n    padding: 8px;\r\n    text-align: left;\r\n}\r\n\r\n.table-container th {\r\n    background-color: rgb(197, 107, 107);\r\n    color: white;\r\n}\r\n\r\n.table-container tr:nth-child(even) {\r\n    background-color: #f2f2f2;\r\n}\r\n\r\n.table-container tr:hover {\r\n    background-color: #ddd;\r\n}\r\n\r\n.header {\r\n    position: relative;  \r\n}\r\n\r\n.table-container .header::after {\r\n    content: \"\";\r\n    display: table;\r\n    clear: both;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}